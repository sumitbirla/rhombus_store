<div class="dropdown pull-right">
  <a class="btn btn-default dropdown-toggle" data-toggle="dropdown" href="#">
    <i class="icon-hand-right"></i> Select Action
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <%= link_to admin_store_order_path(@shipment.order) do %>
          <i class="icon-shopping-cart"></i> View Order
      <% end %>
    </li>
    <li>
      <%= link_to edit_admin_store_shipment_path(@shipment) do %>
          <i class="icon-edit"></i> Modify Shipment
      <% end %>
    </li>
    <li>
      <%= link_to product_labels_admin_store_shipment_path(@shipment) do %>
          <i class="icon-print"></i> Product Labels
      <% end %>
    </li>
    <li>
      <%= link_to invoice_admin_store_shipment_path(@shipment), target: "_blank" do %>
          <i class="icon-file-alt"></i> Print Invoice
      <% end %>
    </li>
    <li>
      <%= link_to packing_slip_admin_store_shipment_path(@shipment), target: "_blank" do %>
          <i class="icon-file-alt"></i> Print Packing Slip
      <% end %>
    </li>
    <li>
      <%= link_to admin_store_easy_post_path(shipment_id: @shipment.id) do %>
        Get Rates and Ship
	    <% end %>
    </li>
  </ul>
</div>


<h2>
  <i class="fa fa-truck"></i> &nbsp;Shipment #<%= @shipment %>
  <span class="label <%= 'label-warning' if @shipment.status == 'pending' %>  <%= 'label-success' if @shipment.status == 'shipped' %>"><%= @shipment.status %></span>
</h2>

<hr style="margin-bottom: 20px;" />

<div class="row">

  <div class="col-md-4">
    <div class="panel panel-primary">
      <div class="panel-heading">Ship From:</div>
      <div class="panel-body">
        <%= @shipment.ship_from_company %><br/>
        <%= @shipment.ship_from_street1 %><br/>
        <%= raw @shipment.ship_from_street2 + '<br/>' unless @shipment.ship_from_street2.blank? %>
        <%= @shipment.ship_from_city %>, <%= @shipment.ship_from_state %> <%= @shipment.ship_from_zip %> <br/>
        <%= Country.find_country_by_alpha2(@shipment.ship_from_country) %>
      </div>
    </div>
  </div>

  <div class="col-md-4">
    <div class="panel panel-primary">
      <div class="panel-heading">Recipient Address:</div>
      <div class="panel-body">
        <%= @shipment.recipient_name %><br/>
        <%= raw @shipment.recipient_company + '<br/>' unless @shipment.recipient_company.blank? %>
        <%= @shipment.recipient_street1 %><br/>
        <%= raw @shipment.recipient_street2 + '<br/>' unless @shipment.recipient_street2.blank? %>
        <%= @shipment.recipient_city %>, <%= @shipment.recipient_state %> <%= @shipment.recipient_zip %> <br/>
        <%= Country.find_country_by_alpha2(@shipment.recipient_country) %>
      </div>
    </div>

  </div>

  <div class="col-md-4">
    <div class="panel panel-primary">
      <div class="panel-heading">Notes:</div>
      <div class="panel-body">
        <%= @shipment.notes %>
      </div>
    </div>
  </div>

</div>


<h4>Items:</h4>

<table class="table table-striped table-condensed table-bordered">
    <tr>
        <th>Item</th>
        <th>Description</th>
        <th class="calign">Ship Qty.</th>
        <th class="calign">Status</th>
    </tr>
    <% @shipment.items.each do |item| %>
        <tr>
            <td nowrap><%= item.order_item.item_id.upcase %></td>
            <td><%= render item.order_item %></td>
            <td class="calign"><%= item.quantity %></td>
            <td class="calign"><%= item.special_status %></td>
        </tr>
    <% end %>
</table>

<br/>


<% if @shipment.status == 'shipped' %>
	<div class="col-md-4" style="padding-left: 0;">
    <% unless @shipment.courier_data.nil? %>
		  <img width="100%" src="<%= label_image_admin_store_shipment_path(@shipment) %>" alt="label image"/>
    <% else %>
    <div style="color: #ccc; font-size: 24px; text-align: center; line-height: 300px; border: solid 1px #ccc;">
      Shipping Label not available
    </div>
    <% end %>
    <%= link_to email_confirmation_admin_store_shipment_path(@shipment) do %>
      <i class="fa fa-envelope"></i> Email confirmation to <%= @shipment.order.notify_email %>
    <% end %>
	</div>
	
	<div class="col-md-8">
	    <%= carrier_image @shipment.ship_method.split[0] unless @shipment.ship_method.blank? %>
	    <table class="table table-condensed table-bordered summary" style="margin-bottom: 10px;">
		  <% unless @shipment.fulfilled_by_id.nil? %>
	      <tr>
	        <td class="key">Fulfilled by:</td>
	        <td><%= link_to @shipment.fulfiller, admin_system_user_path(@shipment.fulfiller) %></td>
	      </tr>
		  <% end %>
	      <tr>
	        <td class="key">Order #:</td>
	        <td><%= link_to @shipment.order_id.to_s, admin_store_order_path(@shipment.order_id) %></td>
	      </tr>
	      <tr>
	        <td class="key" width="160">Service Type:</td>
	        <td><%= @shipment.ship_method %></td>
	      </tr>
	      <tr>
	        <td class="key">Ship Cost:</td>
	        <td><%= number_to_currency(@shipment.ship_cost) %></td>
	      </tr>
        <% unless @shipment.ship_date.nil? %>
	      <tr>
	        <td class="key">Ship Date:</td>
	        <td><%= @shipment.ship_date.strftime("%Y-%m-%d") %></td>
	      </tr>
        <% end %>
	      <tr>
	        <td class="key">Tracking:</td>
	        <td><%= @shipment.tracking_number || "n/a" %></td>
	      </tr>
	      <tr>
	        <td class="key">Package Type:</td>
	        <td><%= @shipment.packaging_type %></td>
	      </tr>
	      <tr>
	        <td class="key">Weight:</td>
	        <td><%= @shipment.package_weight %> lb.</td>
	      </tr>
		  <% if @shipment.packaging_type == 'YOUR PACKAGING'%>
	      <tr>
	        <td class="key">Dimensions:</td>
	        <td><%= @shipment.package_width %>" x <%= @shipment.package_length %>" x <%= @shipment.package_height %>" </td>
	      </tr>
		  <% end %>
	      <tr>
	        <td class="key">Label Format:</td>
	        <td><%= @shipment.label_format %></td>
	      </tr>
	    </table>

    	<% unless @shipment.courier_data.nil? %>
  			<%= link_to "PDF",  label_admin_store_shipment_path(@shipment, format: 'pdf'), class: "btn btn-sm btn-default" %>
  			<%= link_to "EPL2", label_admin_store_shipment_path(@shipment, format: 'epl2'), class: "btn btn-sm btn-default" %>
  			<%= link_to "ZPL", label_admin_store_shipment_path(@shipment, format: 'zpl'), class: "btn btn-sm btn-default" %>
  			<% if @shipment.ship_method.split[0] == 'USPS' %>
          		<%= link_to "Void Shipment", void_label_admin_store_shipment_path(@shipment), class: "btn btn-sm btn-danger pull-right" %>
  			<% end %>
    	<% end %>
    </div>
<% end %>



<%= content_for :title do %>
    Shipment <%= @shipment.order_id %>-<%= @shipment.sequence %>
<% end %>





<% content_for :breadcrumbs do %>
    <li><a href="#">eCommerce</a></li>
    <li><%= link_to 'Shipments', admin_store_shipments_path %></li>
    <li class="active"><%= @shipment %></li>
<% end %>
