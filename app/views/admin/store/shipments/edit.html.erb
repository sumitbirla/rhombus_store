<h2>Shipment #<%= @shipment.order_id %>-<%= @shipment.sequence %></h2>
<hr/>
<%
   pkg_types = %w(YOUR_PACKAGING FEDEX_10KG_BOX FEDEX_25KG_BOX FEDEX_BOX FEDEX_ENVELOPE FEDEX_PAK FEDEX_TUBE)
   drop_off_types =  %w(REGULAR_PICKUP BUSINESS_SERVICE_CENTER DROP_BOX REQUEST_COURIER STATION)
%>


<%= simple_form_for [:admin, :store, @shipment], html: { class: 'form-inline' } do |f| %>
    <%= f.hidden_field :order_id %>
    <%= f.hidden_field :sequence %>
    <%= f.hidden_field :status %>

    <table class="table table-striped table-condensed table-bordered">
      <tr>
        <th>Item</th>
        <th>Description</th>
        <th class="calign">Ordered</th>
        <th class="calign">Shipped</th>
        <th class="calign">Quantity</th>
      </tr>
      <% @shipment.order.items.each do |item|
        shipment_item = @shipment_items.find { |si| si.order_item_id == item.id }
        previously_shipped = ShipmentItem.where("order_item_id = ?", item.id).sum(:quantity) %>
          <tr>
            <td nowrap><%= item.item_id.upcase %></td>
            <td><%= link_to item.item_description, admin_store_product_path(item.product_id) %></td>
            <td class="calign"><%= item.quantity %></td>
            <td class="calign"><%= previously_shipped %></td>
            <td class="calign"><input type="textbox" style="text-align: center;" name="qty-<%= item.id %>" value="<%= shipment_item.quantity || item.quantity - previously_shipped %>" /></td>
          </tr>
      <% end %>
    </table>


    <div class="row">

      <div class="col-md-6">
        <div class="panel panel-primary">
          <div class="panel-heading">Ship From:</div>
          <div class="panel-body">
            <%= f.input :ship_from_company, label: 'Company' %>
            <%= f.input :ship_from_street1, label: 'Street 1' %>
            <%= f.input :ship_from_street2, label: 'Street 2' %>
            <%= f.input :ship_from_city, label: 'City' %>
            <%= f.input :ship_from_state, label: 'State' %>
            <%= f.input :ship_from_zip, label: 'Zipcode' %>
            <%= f.input :ship_from_country, label: 'Country' %>
          </div>
        </div>

        <div class="panel panel-success">
          <div class="panel-body">
            <%= f.input :status, collection: ['pending', 'shipped', 'void', 'cancelled', 'delivered'] %>
            <%= f.input :notes, input_html: { class: '', rows: 2 } %>
          </div>
        </div>
      </div>

      <div class="col-md-6">
        <div class="panel panel-primary">
          <div class="panel-heading">Recipient Address:</div>
          <div class="panel-body">
            <%= f.input :recipient_name, label: 'Recipient' %>
            <%= f.input :recipient_company, label: 'Company' %>
            <%= f.input :recipient_street1, label: 'Street 1' %>
            <%= f.input :recipient_street2, label: 'Street 2' %>
            <%= f.input :recipient_city, label: 'City' %>
            <%= f.input :recipient_state, label: 'State' %>
            <%= f.input :recipient_zip, label: 'Zipcode' %>
            <%= f.input :recipient_country, label: 'Country' %>
          </div>
        </div>
      </div>

    </div>

    <%= f.button :submit, class: 'btn-primary' %>

<% end %>



<%= content_for :title do %>
    Shipment <%= @shipment.order_id %>-<%= @shipment.sequence %>
<% end %>


<% content_for :head do %>
    <style>
        .form-inline .form-group { margin: 10px 0; }
    </style>
<% end %>


<% content_for :breadcrumbs do %>
    <li><a href="#">eCommerce</a></li>
    <li><%= link_to 'Orders', admin_store_orders_path %></li>
    <li><%= link_to '#' + @shipment.order_id.to_s, admin_store_order_path(@shipment.order_id)%></li>
    <li><%= link_to "Shipment " + @shipment.to_s, admin_store_shipment_path(@shipment.id)%></li>
    <li class="active">edit</li>
<% end %>
