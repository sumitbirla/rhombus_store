<div class="pull-right">
  <select id="selAction" class="form-control" style="display: inline; width: 75%">
    <option> - - Select Action - - </option>
	  <option method="get" value="<%= admin_store_shipments_choose_order_path %>">New Shipment</option>
    <option method="get" value="/admin/store/shipments_batch">Batch Ship</option>
    <option method="post" value="/admin/store/shipments_packing_slip_batch">Packing Slips (PDF)</option>
    <option method="post" value="/admin/store/shipments_invoice_batch">Invoices (PDF)</option>
    <option method="get" value="/admin/store/shipments/product_labels">Product Labels</option>
    <optgroup label="Change order status to ">
        <option method="post" value="/admin/store/shipments_update_status?status=shipped">Shipped</option>
        <option method="post" value="/admin/store/shipments_update_status?status=pending">Pending</option>
        <option method="post" value="/admin/store/shipments_update_status?status=void">Void</option>
    </optgroup>
  </select>
  <input type="button" class="btn btn-default btn-small" id="btnAction" value="Go" />	  
</div>

<h2><i class="fa fa-truck"></i> &nbsp;Shipments</h2>

<%= render "admin/shared/search_results_header", object: @shipments %>

<form id="frmBatch" action="" method="post">
	<%= token_tag %>
	
<%= will_paginate @shipments %>
<table class="table table-striped table-condensed">
  <tr>
	<th><input type="checkbox" id="chkAll" /></th>
    <th>ID</th>
    <th>Created</th>
    <th>Ship to</th>
    <th>Destination</th>
    <th>Shipped</th>
    <th>Method</th>
    <th>Status</th>
    <th>&nbsp;</th>
  </tr>
  <% @shipments.each do |shipment|  %>
      <tr>
		<td><input type="checkbox" name="shipment_id[]" class="shipment-chk" value="<%= shipment.id %>"/></td>
        <td nowrap><%= link_to shipment, admin_store_shipment_path(shipment) %></td>
        <td nowrap class="light"><%= systime shipment.created_at %></td>
        <td><%= shipment.recipient_name %></td>
        <td><%= shipment.recipient_city %>, <%= shipment.recipient_state %></td>
        <td><%= shipment.ship_date ? sysdate(shipment.ship_date) : "<span class='light'>-</span>".html_safe %></td>
        <td><%= shipment.ship_method.blank? ? '<span class="light">- n/a -</span>'.html_safe : "#{shipment.carrier} #{shipment.ship_method}" %></td>
        <td><span class="label <%= 'label-warning' if shipment.status == 'pending' %>  <%= 'label-success' if shipment.status == 'shipped' %> <%= 'label-danger' if shipment.status == 'void' %>"><%= shipment.status %></span></td>
        <td class="ralign">
          <% if shipment.status == "pending" %>
            <%= link_to "ship", admin_store_easy_post_path(shipment_id: shipment.id) %> &nbsp;
          <% end %>
          <%= link_to "edit", edit_admin_store_shipment_path(shipment) %> &nbsp;
          <%= link_to "delete",
                      { action: "destroy", id: shipment.id },
                      method: :delete,
                      data: { confirm: "Are you sure?" } %>
        </td>
      </tr>
  <% end %>
</table>
</form>

<div class="table-summary">
	<%= number_with_delimiter(@shipments.total_entries) %> records | <%= link_to 'CSV', admin_store_shipments_path(format: :csv) %>
</div>


<%= content_for :title do %>
    Shipments
<% end %>



<% content_for :breadcrumbs do %>
    <li><a href="#">eCommerce</a></li>
    <li class="active">Shipments</li>
<% end %>


<% content_for :head do %>

	<script type="text/javascript">
	    $(document).ready(function () {

	        $("#btnAction").click(function () {
	            $("#frmBatch").attr("action", $("#selAction").val());
	            $("#frmBatch").attr("method", $("#selAction option:selected").attr("method"));
	            $("#frmBatch").submit();
	        });

          $("#chkAll").change(function() {

            if ($(this).prop("checked"))
              $(".shipment-chk").prop("checked", true);
            else
              $(".shipment-chk").prop("checked", false);
          });

	    });
    </script>

<% end %>